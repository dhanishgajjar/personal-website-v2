{{ define "content" }} {{ partial "navigation" . }}
<div class="container">
  {{ $books := getJSON "https://goodreads-api.now.sh" }}
  <h1>Book Recommendations</h1>
  <p>
    I have read a lot of books. But these {{ len $books }} books are my favourites and which I would like to recommend.
  </p>
  <ul class="books">
    {{ range sort $books }}
    {{ $url := index .image_url 0 }}
    {{ $slicedTitle := index (split (index .title 0) ":") 0 }}
    <li>
      <img src="{{ $url }}" alt="{{ $slicedTitle }}" />
      <h2>{{ $slicedTitle }}</h2>
      {{ $authors := index .authors 0 }}
      {{ range $authors }}
      {{ range . }}
      <h3>by {{ index .name 0 }}</h3>
      {{ end }}
      {{ end }}
      <a href="http://www.bookdepository.com/book/{{ index .isbn13 0 }}/?a_aid=tripprblog">Buy</a>
    </li>
    {{ end }}
  </ul>
</div>
{{ end }}
